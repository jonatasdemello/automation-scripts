# Azcopy

CDN Purge:
https://learn.microsoft.com/en-us/powershell/module/az.cdn/clear-azcdnendpointcontent?view=azps-11.2.0

Clear-AzCdnEndpointContent -ResourceGroupName testps-rg-da16jm -ProfileName cdn001 -EndpointName endptest001 -ContentPath @("/movies/*","/pictures/pic1.jpg")

$contentPath = @("/movies/amazing.mp4","/pictures/pic1.jpg")
$contentFilePath = New-AzCdnPurgeParametersObject -ContentPath $contentPath
Clear-AzCdnEndpointContent -ResourceGroupName testps-rg-da16jm -ProfileName cdn001 -EndpointName endptest001 -ContentFilePath $contentFilePath


https://learn.microsoft.com/en-us/azure/storage/common/storage-ref-azcopy

https://learn.microsoft.com/en-us/azure/storage/common/storage-use-azcopy-configure


The logs will contain the status of failure (UPLOADFAILED, COPYFAILED, and DOWNLOADFAILED), the full path, and the reason of the failure.

By default, the log and plan files are located in the
%USERPROFILE%\.azcopy directory on Windows or
$HOME$\.azcopy directory on Mac and Linux, but you can change that location.

Use the azcopy env to check the current value of this variable.
If the value is blank, then plan files are written to the default location.

azcopy env


Azcopy



Windows (PowerShell)

Select-String UPLOADFAILED .\04dc9ca9-158f-7945-5933-564021086c79.log

Linux

grep UPLOADFAILED .\04dc9ca9-158f-7945-5933-564021086c79.log

View and resume jobs

Each transfer operation will create an AzCopy job. Use the following command to view the history of jobs:

azcopy jobs list

To view the job statistics, use the following command:

azcopy jobs show <job-id>

To filter the transfers by status, use the following command:

azcopy jobs show <job-id> --with-status=Failed

Tip

The value of the --with-status flag is case-sensitive.

Use the following command to resume a failed/canceled job. This command uses its identifier along with the SAS token as it isn't persistent for security reasons:

azcopy jobs resume <job-id> --source-sas="<sas-token>" --destination-sas="<sas-token>"

Change the location of plan files

Windows 	PowerShell:$env:AZCOPY_JOB_PLAN_LOCATION="<value>"
In a command prompt use:: set AZCOPY_JOB_PLAN_LOCATION=<value>
Linux 	export AZCOPY_JOB_PLAN_LOCATION=<value>
macOS 	export AZCOPY_JOB_PLAN_LOCATION=<value>

Change the location of log files

Windows 	PowerShell:$env:AZCOPY_LOG_LOCATION="<value>"
In a command prompt use:: set AZCOPY_LOG_LOCATION=<value>
Linux 	export AZCOPY_LOG_LOCATION=<value>
macOS 	export AZCOPY_LOG_LOCATION=<value>

Remove plan and log files

If you want to remove all plan and log files from your local machine to save disk space,
use the azcopy jobs clean command.

azcopy jobs clean

To remove the plan and log files associated with only one job,
use azcopy jobs rm <job-id>.
Replace the <job-id> placeholder in this example with the job ID of the job.

azcopy jobs rm <job-id>



