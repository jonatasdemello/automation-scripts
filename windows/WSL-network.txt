ip route

default via 172.31.16.1 dev eth0 proto kernel
172.31.16.0/20 dev eth0 proto kernel scope link src 172.31.30.139

The "default via" address is the address to use for the Windows host.

---------------------------------------------------------------------------------------------------
cat /etc/resolv.conf

# This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf:
# [network]
# generateResolvConf = false
nameserver 10.255.255.254
search anaca.local home


You could parse it from the above, or from /etc/resolv.conf, but WSL also sets up a convenience mDNS, the .local domain, using the Windows "computer name", which is also used as the hostname of the WSL instance.

Accessing it is by concatenating $(hostname) with .local.

Try:

ping "$(hostname).local"

Or, if ICMP is blocked (seems so on new Windows 11 installs), use netcat. 
It's available by default in the WSL Ubuntu installation, but may need to be installed in other distributions like openSUSE:

nc -zv "$(hostname).local" <portnumber>

---------------------------------------------------------------------------------------------------


wsl.exe --list --verbose
wsl.exe --set-default-version <1|2>
wsl.exe --set-default <Distro>
wsl.exe --distribution <DistroName>

wsl --list --running
wsl --shutdown
wsl --terminate <distroName>


Scenario One: From the perspective of the Windows host, you want to query a Linux distribution's IP address running via WSL2, so that a program on Windows host can connect to a server program running inside the distribution (instance).

wsl.exe --distribution <DistroName> hostname -i
127.0.1.1

Scenario Two: A program running inside a Linux distribution via WSL2 (instance) wants to know the Windows host's IP address, so that a Linux program can connect to a Windows host server program.
Show is the host IP address for Windows:

ip route show | grep -i default | awk '{ print $3}'

eth0
192.168.2.1

cat /etc/resolv.conf

https://learn.microsoft.com/en-us/windows/wsl/networking

# Using NAT

windows: node app.js  => http://127.0.0.1:5000
wsl: 
cat /etc/resolv.conf
nameserver 192.168.96.193
curl http://192.168.96.193:5000

# Using Mirror

Connect to Windows servers from within Linux using the localhost address 127.0.0.1. IPv6 localhost address ::1 is not supported


Firewall:
Run the following command in PowerShell window with admin privileges to Configure Hyper-V firewall settings to allow inbound connections:

Set-NetFirewallHyperVVMSetting -Name '{40E0AC32-46A5-438A-A0B2-2B479E8F2E90}' -DefaultInboundAction Allow

New-NetFirewallHyperVRule -Name "MyWebServer" -DisplayName "My Web Server" -Direction Inbound -VMCreatorId '{40E0AC32-46A5-438A-A0B2-2B479E8F2E90}' -Protocol TCP -LocalPorts 80


---------------------------------------------------------------------------------------------------

%UserProfile%\.wslconfig
/etc/wsl.conf

\\wsl.localhost\Ubuntu-20.04\etc\wsl.conf

.wslconfig

Configure global settings with .wslconfig across all installed distributions running on WSL.

    The .wslconfig file does not exist by default. It must be created and stored in your %UserProfile% directory to apply these configuration settings.
    Used to configure settings globally across all installed Linux distributions running as the WSL 2 version.
    Can be used only for distributions run by WSL 2. Distributions running as WSL 1 will not be affected by this configuration as they are not running as a virtual machine.
    To get to your %UserProfile% directory, in PowerShell, use cd ~ to access your home directory (which is typically your user profile, C:\Users\<UserName>) or you can open Windows File Explorer and enter %UserProfile% in the address bar. The directory path should look something like: C:\Users\<UserName>\.wslconfig.

WSL will detect the existence of these files, read the contents, and automatically apply the configuration settings every time you launch WSL. If the file is missing or malformed (improper markup formatting), WSL will continue to launch as normal without the configuration settings applied.

