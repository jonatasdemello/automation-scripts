DISM /online /get-packages

dism.exe -online -get-features



    dism /online /get-features /format:table
    dism /online /get-featureInfo /featureName:iis-asp
    dism /online /get-packages /format:table
    dism /online /get-packageInfo /packageName:Package_for_KB2880289~31bf3856ad364e35~amd64~~6.3.1.0
    dism /online /enable-feature /featureName:iis-asp /all [/source]
    dism /online /disable-feature /featureName:iis-asp [/remove]


    /limitAccess : This optionally prevents DISM from contacting Windows Updates or WSUS.
    /all : This optionally enables all parent features of the specified feature.

	dism /get-imageInfo /imageFile:h:\sources\install.wim


DISM.exe /Online /Cleanup-image /Restorehealth
DISM.exe /Online /Cleanup-Image /RestoreHealth /Source:C:\RepairSource\Windows /LimitAccess

DISM.exe /Online /Cleanup-Image /RestoreHealth /Source:E:\Sources\Windows /LimitAccess
sfc /scannow
run windows update


DISM /Online /Enable-Feature /FeatureName:IIS-ManagementService /All /Source:WIM:E:\sources\install.wim:4 /LimitAccess
DISM /Online /Enable-Feature /FeatureName:IIS-ManagementConsole /All /Source:WIM:E:\sources\install.wim:4 /LimitAccess

DISM /Online /Enable-Feature /FeatureName:IIS-IIS6ManagementCompatibility /FeatureName:IIS-ManagementConsole


	WIM:E:\sources\install.wim:4
	E:\Sources\SxS\
	/Source:WIM:E:\sources\install.wim:4

Error: 0x800f081f

dism /online /enable-feature /featurename:NetFx3 /All /Source:[Drive]:\sources\sxs /LimitAccess

DISM /Online /Enable-Feature /FeatureName:NetFx3 /All /LimitAccess /Source:e:\sources\sxs

Get-windowsOptionalFeature -online |FT


https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/dism-global-options-for-command-line-syntax?view=windows-11

IIS
https://learn.microsoft.com/en-us/previous-versions/technet-magazine/dn236383(v=msdn.10)?redirectedfrom=MSDN

Install-WindowsFeature –Name Web-Server –IncludeManagementTools

PS C:\> Get-Service –Name AppHostSVC, W3SVC, WAS
PS C:\> Get-Module -ListAvailable
PS C:\> Import-Module –Name WebAdministration

PS C:\> Get-Help *Web*
PS C:\> Get-Command –Module WebAdministration
PS C:\> Get-ChildItem -Path IIS:

PS C:\> Get-Website –Name 'Default Web Site'
PS C:\> Get-Childitem –Path IIS:\Sites
PS C:\>Get-ChildItem –Path 'IIS:\Sites\Default web site'


1. Right click at Start menu image and select Command Prompt (Admin).
2. Type the following commands in order:

	DISM /Online /Cleanup-Image /StartComponentCleanup
	SFC /SCANNOW
	DISM /Online  /Cleanup-Image /AnalyzeComponentStore
	SFC /SCANNOW

3. Restart your computer.
4. After the restart, open command prompt (as admin) again and run DISM.

	DISM /Online /Cleanup-Image /RestoreHealth


https://learn.microsoft.com/en-ca/windows-hardware/manufacture/desktop/configure-a-windows-repair-source?view=windows-11#use-windowsupdate-to-restore-optional-features-and-repair-windows-images


https://learn.microsoft.com/en-ca/windows-hardware/manufacture/desktop/enable-or-disable-windows-features-using-dism?view=windows-11


Use the /Get-ImageInfo option to retrieve the name or index number for the image that you want to modify.

Dism /Get-ImageInfo /ImageFile:C:\test\images\install.wim

Dism /Get-ImageInfo /ImageFile:E:\sources\install.wim
DISM /Get-WimInfo /WimFile:E:sources/install.wim

Mount the offline Windows image.

Dism /Mount-Image /ImageFile:C:\test\images\install.wim /Index:1 /MountDir:C:\test\offline

List all of the features available in the operating system

Dism /online /Get-Features
Dism /online /Get-FeatureInfo /FeatureName:TFTP

Dism /Image:C:\test\offline /Get-Features



	/Source:WIM:E:\sources\install.wim:4


SFC /scannow

#1. Windows Repair

DISM /Online /Cleanup-Image /CheckHealth
DISM /Online /Cleanup-Image /ScanHealth
DISM /Online /Cleanup-Image /StartComponentCleanup
DISM /Online /Cleanup-Image /RestoreHealth

sfc /scannow


Type DISM /Online /Cleanup-Image /StartComponentCleanup
Type DISM /Online /Cleanup-Image /RestoreHealth
Type sfc /scannow

#2. Clean & Analyze the WinSXS Folder

Type DISM /Online /Cleanup-Image /StartComponentCleanup
Type sfc /scannow
Type DISM /Online /Cleanup-Image /AnalyzeComponentStore
Type sfc /scannow
restart

#3. Use an Alternative Repair Source in DISM

Step 1: check the Index number on your Windows 10.

Connect the USB drive that contains the Windows installation media (or mount the ISO file) to your computer.
Press Windows + E to open File Explorer. Then, go to your USB drive.
Double click on the Sources folder to check whether it contains an install.wim or install.esd file.
Run Command Prompt as administrator. Type:

DISM /Get-WimInfo /WimFile:*:sources/install.wim
DISM /Get-WimInfo /WimFile:*:sources/install.esd
(* represents the drive letter). Then, press Enter.


DISM /Get-WimInfo /WimFile:E:\sources\install.wim

Step 2: repair Windows 10. Please replace * with the drive letter of your USB drive and type the correct Index Number.

If the Sources folder contain an install.wim:
	DISM /Online /Cleanup-Image /RestoreHealth /Source:WIM:*:\sources\install.wim:IndexNumber /LimitAccess

If the Sources folder contain an install.esd:
	DISM /Online /Cleanup-Image /RestoreHealth /Source:ESD:*:\sources\install.esd:IndexNumber /LimitAccess


List indexes:

DISM /Get-WimInfo /WimFile:E:sources/install.wim

DISM /Online /Cleanup-Image /RestoreHealth /Source:WIM:E:\sources\install.wim:4 /LimitAccess


DISM /online /enable-feature /featurename:IIS-WebServer /all


Dism /online /Get-Features


DISM /online /enable-feature /featurename:NETfx4ServerFeatures /all
DISM /online /enable-feature /featurename:NETfx4 /all

DISM /online /enable-feature /featurename:IIS-WebServer /all
DISM /online /enable-feature /featurename:IIS-WebServerRole /all


dism /online /enable-feature /featurename:IIS-ASPNET45 /all
dism /online /enable-feature /featurename:IIS-ASPNET45
dism /online /enable-feature /featurename:IIS-ASPNET45 /all /Source:WIM:E:\sources\install.wim:4 /LimitAccess


Dism /online /Get-Features


Feature Name : Server-Core
Feature Name : NetFx4ServerFeatures
Feature Name : NetFx4
Feature Name : NetFx4Extended-ASPNET45
Feature Name : WCF-Services45
Feature Name : WCF-HTTP-Activation45
Feature Name : WCF-TCP-Activation45
Feature Name : WCF-Pipe-Activation45
Feature Name : WCF-MSMQ-Activation45
Feature Name : WCF-TCP-PortSharing45
Feature Name : ManagementOdata
Feature Name : DSC-Service
Feature Name : DeviceHealthAttestationService
Feature Name : IPAMServerFeature
Feature Name : RightsManagementServices-Role
Feature Name : RightsManagementServices
Feature Name : RMS-Federation
Feature Name : RightsManagementServices-AdminTools
Feature Name : ADCertificateServicesRole
Feature Name : CertificateServices
Feature Name : OnlineRevocationServices
Feature Name : WebEnrollmentServices
Feature Name : NetworkDeviceEnrollmentServices
Feature Name : CertificateEnrollmentPolicyServer
Feature Name : CertificateEnrollmentServer
Feature Name : HostGuardianService-Package
Feature Name : Web-Application-Proxy
Feature Name : IdentityServer-SecurityTokenService
Feature Name : NetworkController
Feature Name : ActiveDirectory-PowerShell
Feature Name : DirectoryServices-AdministrativeCenter
Feature Name : DirectoryServices-DomainController
Feature Name : DirectoryServices-ISM-Smtp
Feature Name : AuthManager
Feature Name : IPAMClientFeature
Feature Name : UpdateServices-RSAT
Feature Name : UpdateServices-API
Feature Name : UpdateServices-UI
Feature Name : UpdateServices
Feature Name : UpdateServices-Services
Feature Name : UpdateServices-Database
Feature Name : UpdateServices-WidDatabase
Feature Name : WebAccess
Feature Name : FSRM-Infrastructure
Feature Name : Microsoft-Windows-FCI-Client-Package

Feature Name : IIS-WebServerRole
Feature Name : IIS-WebServer
Feature Name : IIS-CommonHttpFeatures
Feature Name : IIS-Security
Feature Name : IIS-RequestFiltering
Feature Name : IIS-StaticContent
Feature Name : IIS-DefaultDocument
Feature Name : IIS-DirectoryBrowsing
Feature Name : IIS-HttpErrors
Feature Name : IIS-HttpRedirect
Feature Name : IIS-WebDAV
Feature Name : IIS-ApplicationDevelopment
Feature Name : IIS-WebSockets
Feature Name : IIS-ApplicationInit
Feature Name : IIS-NetFxExtensibility
Feature Name : IIS-NetFxExtensibility45
Feature Name : IIS-ISAPIExtensions
Feature Name : IIS-ISAPIFilter
Feature Name : IIS-ASPNET
Feature Name : IIS-ASPNET45
Feature Name : IIS-ASP
Feature Name : IIS-CGI
Feature Name : IIS-ServerSideIncludes
Feature Name : IIS-HealthAndDiagnostics
Feature Name : IIS-HttpLogging
Feature Name : IIS-LoggingLibraries
Feature Name : IIS-RequestMonitor
Feature Name : IIS-HttpTracing
Feature Name : IIS-CustomLogging
Feature Name : IIS-ODBCLogging
Feature Name : IIS-CertProvider
Feature Name : IIS-BasicAuthentication
Feature Name : IIS-WindowsAuthentication
Feature Name : IIS-DigestAuthentication
Feature Name : IIS-ClientCertificateMappingAuthentication
Feature Name : IIS-IISCertificateMappingAuthentication
Feature Name : IIS-URLAuthorization
Feature Name : IIS-IPSecurity
Feature Name : IIS-Performance
Feature Name : IIS-HttpCompressionStatic
Feature Name : IIS-HttpCompressionDynamic
Feature Name : IIS-WebServerManagementTools
Feature Name : IIS-ManagementConsole
Feature Name : IIS-LegacySnapIn
Feature Name : IIS-ManagementScriptingTools
Feature Name : IIS-ManagementService
Feature Name : IIS-IIS6ManagementCompatibility
Feature Name : IIS-Metabase
Feature Name : IIS-WMICompatibility
Feature Name : IIS-LegacyScripts
Feature Name : IIS-FTPServer
Feature Name : IIS-FTPSvc
Feature Name : IIS-FTPExtensibility

Feature Name : WAS-WindowsActivationService
Feature Name : WAS-ProcessModel
Feature Name : WAS-NetFxEnvironment
Feature Name : WAS-ConfigurationAPI

Feature Name : IIS-HostableWebCore
Feature Name : BITSExtensions-AdminPack
Feature Name : BITSExtensions-Upload
Feature Name : WCF-HTTP-Activation
Feature Name : WCF-NonHTTP-Activation
Feature Name : WindowsPowerShellWebAccess
Feature Name : Smtpsvc-Admin-Update-Name
Feature Name : Smtpsvc-Service-Update-Name
Feature Name : RPC-HTTP_Proxy
Feature Name : Printing-InternetPrinting-Server
Feature Name : Gateway-UI
Feature Name : Gateway
Feature Name : WorkFolders-Server
Feature Name : RemoteAccess
Feature Name : RemoteAccessServer
Feature Name : RasRoutingProtocols
Feature Name : Microsoft-Windows-Web-Services-for-Management-IIS-Extension
Feature Name : MSMQ
Feature Name : MSMQ-Services
Feature Name : MSMQ-DCOMProxy
Feature Name : MSMQ-Server
Feature Name : MSMQ-ADIntegration
Feature Name : MSMQ-HTTP
Feature Name : MSMQ-Multicast
Feature Name : MSMQ-Triggers
Feature Name : MSMQ-RoutingServer
Feature Name : FSRM-Infrastructure-Services
Feature Name : DirectoryServices-ADAM
Feature Name : MicrosoftWindowsPowerShellRoot
Feature Name : MicrosoftWindowsPowerShell
Feature Name : iSCSITargetServer-PowerShell
Feature Name : PKIClient-PSH-Cmdlets
Feature Name : KeyDistributionService-PSH-Cmdlets
Feature Name : Tpm-PSH-Cmdlets
Feature Name : MicrosoftWindowsPowerShellV2
Feature Name : TlsSessionTicketKey-PSH-Cmdlets
Feature Name : RemoteAccessMgmtTools
Feature Name : RemoteAccessPowerShell
Feature Name : RasServerAdminTools
Feature Name : DamgmtTools
Feature Name : NetworkControllerTools
Feature Name : DataCenterBridging-LLDP-Tools
Feature Name : Server-Psh-Cmdlets
Feature Name : ServerCore-WOW64
Feature Name : Printing-Server-Foundation-Features
Feature Name : Printing-Server-Role
Feature Name : Printing-LPDPrintService
Feature Name : Printing-Client
Feature Name : Printing-Client-Gui
Feature Name : NetFx3ServerFeatures
Feature Name : NetFx3
Feature Name : MediaPlayback
Feature Name : WindowsMediaPlayer
Feature Name : Printing-XPSServices-Features
Feature Name : TFTP
Feature Name : LegacyComponents
Feature Name : DirectPlay
Feature Name : Windows-Identity-Foundation
Feature Name : MultiPoint-Connector
Feature Name : MultiPoint-Connector-Services
Feature Name : MultiPoint-Tools
Feature Name : FailoverCluster-AdminPak
Feature Name : HardenedFabricEncryptionTask
Feature Name : SimpleTCP
Feature Name : SmbDirect
Feature Name : Windows-Defender
Feature Name : EnhancedStorage
Feature Name : Server-Manager-RSAT-File-Services
Feature Name : Server-RSAT-SNMP
Feature Name : WINS-Server-Tools
Feature Name : BitLocker-RemoteAdminTool
Feature Name : BdeAducExtTool
Feature Name : RSAT-RDS-Tools-Feature
Feature Name : Microsoft-Windows-Deployment-Services-Admin-Pack
Feature Name : DHCPServer-Tools
Feature Name : NetworkLoadBalancingManagementClient
Feature Name : RightsManagementServicesManagementTools
Feature Name : Security-SPP-Vmw
Feature Name : File-Services-Search-Service
Feature Name : iSCSITargetStorageProviders
Feature Name : BITS
Feature Name : LightweightServer
Feature Name : MultipathIo
Feature Name : Printing-PrintToPDFServices-Features
Feature Name : SNMP
Feature Name : WMISnmpProvider
Feature Name : WindowsStorageManagementService
Feature Name : Xps-Foundation-Xps-Viewer
Feature Name : SMBBW
Feature Name : MSRDC-Infrastructure
Feature Name : WINSRuntime
Feature Name : RasCMAK
Feature Name : Remote-Desktop-Services
Feature Name : SBMgr-UI
Feature Name : SessionDirectory
Feature Name : AppServer
Feature Name : VmHostAgent
Feature Name : NPAS-Role
Feature Name : SearchEngine-Server-Package
Feature Name : BitLocker-NetworkUnlock
Feature Name : FailoverCluster-AutomationServer
Feature Name : FailoverCluster-CmdInterface
Feature Name : FRS-Infrastructure
Feature Name : ResumeKeyFilter
Feature Name : SmbWitness
Feature Name : iSCSITargetServer
Feature Name : BiometricFramework
Feature Name : SetupAndBootEventCollection
Feature Name : ServerManager-Core-RSAT
Feature Name : ServerManager-Core-RSAT-Role-Tools
Feature Name : ServerManager-Core-RSAT-Feature-Tools
Feature Name : DNS-Server-Tools
Feature Name : RSAT-AD-Tools-Feature
Feature Name : RSAT-ADDS-Tools-Feature
Feature Name : DirectoryServices-DomainController-Tools
Feature Name : DirectoryServices-ADAM-Tools
Feature Name : ShieldedVMToolsAdminPack
Feature Name : Storage-Replica-AdminPack
Feature Name : Microsoft-Hyper-V
Feature Name : Microsoft-Hyper-V-Offline
Feature Name : Microsoft-Hyper-V-Online
Feature Name : RSAT-Hyper-V-Tools-Feature
Feature Name : Microsoft-Hyper-V-Management-Clients
Feature Name : Microsoft-Hyper-V-Management-PowerShell
Feature Name : HostGuardian
Feature Name : NetworkVirtualization
Feature Name : NetworkLoadBalancingFullServer
Feature Name : PeerDist
Feature Name : P2P-PnrpOnly
Feature Name : QWAVE
Feature Name : RemoteAssistance
Feature Name : BitLocker
Feature Name : Bitlocker-Utilities
Feature Name : ServicesForNFS-ServerAndClient
Feature Name : ClientForNFS-Infrastructure
Feature Name : ServerForNFS-Infrastructure
Feature Name : TIFFIFilter
Feature Name : WirelessNetworking
Feature Name : WebDAV-Redirector
Feature Name : TelnetClient
Feature Name : DfsMgmt
Feature Name : ADCertificateServicesManagementTools
Feature Name : CertificateServicesManagementTools
Feature Name : OnlineRevocationServicesManagementTools
Feature Name : NPSMMC
Feature Name : Licensing-UI
Feature Name : Licensing-Diagnosis-UI
Feature Name : NFS-Administration
Feature Name : WindowsServerBackupSnapin
Feature Name : FaxServiceConfigRole
Feature Name : NPSManagementTools
Feature Name : FSRM-Management
Feature Name : CCFFilter
Feature Name : FabricShieldedTools
Feature Name : DiskIo-QoS
Feature Name : SMBHashGeneration
Feature Name : DFSN-Server
Feature Name : DFSR-Infrastructure-ServerEdition
Feature Name : DHCPServer
Feature Name : Licensing
Feature Name : SoftwareLoadBalancer
Feature Name : Server-Drivers-General
Feature Name : Server-Drivers-Printers
Feature Name : OEM-Appliance-OOBE
Feature Name : WindowsServerBackup
Feature Name : Dedup-Core
Feature Name : FileServerVSSAgent
Feature Name : SMB1Protocol
Feature Name : SMB1Protocol-Client
Feature Name : SMB1Protocol-Server
Feature Name : Microsoft-Windows-MultiPoint-Connector
Feature Name : Microsoft-Windows-PhotoBasic
Feature Name : Microsoft-Windows-Printing-PremiumTools
Feature Name : Microsoft-Windows-StorageService
Feature Name : Microsoft-Windows-Deployment-Services
Feature Name : Microsoft-Windows-Deployment-Services-Transport-Server
Feature Name : Microsoft-Windows-Deployment-Services-Deployment-Server
Feature Name : DataCenterBridging
Feature Name : ServerMigration
Feature Name : Microsoft-Windows-GroupPolicy-ServerAdminTools-Update
Feature Name : Windows-Internal-Database
Feature Name : FailoverCluster-PowerShell
Feature Name : Server-Shell
Feature Name : Internet-Explorer-Optional-amd64
Feature Name : FaxServiceRole
Feature Name : Server-Gui-Mgmt
Feature Name : Server-Gui-Mgmt_onecore
Feature Name : RSAT
Feature Name : FailoverCluster-Mgmt
Feature Name : ServerMediaFoundation
Feature Name : Printing-LPRPortMonitor
Feature Name : Printing-InternetPrinting-Client
Feature Name : Printing-AdminTools-Collection
Feature Name : FailoverCluster-FullServer
Feature Name : Containers
Feature Name : Containers-HNS
Feature Name : Containers-SDN
Feature Name : Storage-Replica
Feature Name : DNS-Server-Full-Role
Feature Name : VolumeActivation-Full-Role
Feature Name : SearchEngine-Client-Package
Feature Name : FileAndStorage-Services
Feature Name : Storage-Services
Feature Name : File-Services
Feature Name : CoreFileServer
Feature Name : ServerCoreFonts-NonCritical-Fonts-MinConsoleFonts
Feature Name : ServerCoreFonts-NonCritical-Fonts-BitmapFonts
Feature Name : ServerCoreFonts-NonCritical-Fonts-TrueType
Feature Name : ServerCoreFonts-NonCritical-Fonts-UAPFonts
Feature Name : ServerCoreFonts-NonCritical-Fonts-Support
Feature Name : SystemInsightsManagement
Feature Name : SystemInsights
Feature Name : SystemDataArchiver
Feature Name : StorageMigrationServiceManagement
Feature Name : StorageMigrationService
Feature Name : StorageMigrationServiceProxy
Feature Name : ServerCore-Drivers-General
Feature Name : ServerCore-Drivers-General-WOW64
Feature Name : Client-ProjFS
Feature Name : HypervisorPlatform
Feature Name : VirtualMachinePlatform
Feature Name : Microsoft-Windows-Subsystem-Linux
